---
title: Complete an incoming payment
---

import { CodeBlock, LinkOut } from '@interledger/docs-design-system'
import { Tabs, TabItem, LinkButton } from '@astrojs/starlight/components'
import ChunkedSnippet from '/src/components/ChunkedSnippet.astro'
import Begin from '/src/partials/before-you-begin.mdx'
import Ts from '/src/partials/ts-init-config.mdx'
import TsImport from '/src/partials/ts-import-initialize.mdx'

An authorized client can complete an unexpired incoming payment to indicate it will not send any additional payments to the wallet address.

These code snippets pass the wallet address and incoming payment URL to the resource server and mark the payment as completed.

## Before you begin

<Begin />

## Mark an incoming payment as complete

<Tabs>
<TabItem label='TypeScript/JavaScript' icon='seti:javascript'>
<LinkButton href="https://github.com/interledger/open-payments-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<details>
  <summary>Initial configuration</summary>
  <Ts />
</details>

<TsImport />

<ChunkedSnippet
  source="incoming-payment/incoming-payment-complete.ts"
  l="node"
  chunk="3"
/>

<ChunkedSnippet
  source="incoming-payment/incoming-payment-complete.ts"
  l="node"
  chunk="4"
/>

For TypeScript, run `tsx path/to/directory/index.ts`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/incoming-payment/incoming-payment-complete.ts'>View full TS source</LinkOut>

For JavaScript, run `node path/to/directory/index.js`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/incoming-payment/incoming-payment-complete.js'>View full JS source</LinkOut>

</TabItem>
<TabItem label="Rust" icon='seti:rust'>
<LinkButton href="https://github.com/interledger/open-payments-rust/tree/main/src/snippets#readme" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<ChunkedSnippet
  source="incoming-payment/incoming-payment-complete.rs"
  l="rust"
  chunk="1"
/>

<ChunkedSnippet
  source="incoming-payment/incoming-payment-complete.rs"
  l="rust"
  chunk="2"
/>

<ChunkedSnippet
  source="incoming-payment/incoming-payment-complete.rs"
  l="rust"
  chunk="3"
/>

<ChunkedSnippet
  source="incoming-payment/incoming-payment-complete.rs"
  l="rust"
  chunk="4"
/>

<p>
  <LinkOut href="https://github.com/interledger/open-payments/blob/main/snippets/rust/incoming-payment/incoming-payment-complete.rs">
    View full Rust source
  </LinkOut>
</p>

</TabItem>
<TabItem label='PHP' icon='seti:php'>
<LinkButton href="https://github.com/interledger/open-payments-php-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

```php
// Import dependencies
use OpenPayments\AuthClient;
use OpenPayments\Config\Config;

// Initialize Open Payments client
$config = new Config(
    $WALLET_ADDRESS,
    $PRIVATE_KEY,
    $KEY_ID
);
$opClient = new AuthClient($config);

// Complete incoming payment
$incomingPayment = $opClient->incomingPayment()->complete(
    [
        'access_token' => $INCOMING_PAYMENT_GRANT_ACCESS_TOKEN,
        'url' => $INCOMING_PAYMENT_URL
    ]
);

// Output
echo 'COMPLETE INCOMING PAYMENT: '. PHP_EOL . print_r($incomingPayment, true);
```

<p><LinkOut href='https://github.com/interledger/open-payments-php-snippets/blob/main/src/Command/IncomingPayment/IncomingPaymentComplete.php'>View full source</LinkOut></p>
</TabItem>

<TabItem label="Go" icon='seti:go'>
<LinkButton href="https://github.com/interledger/open-payments-go/blob/main/README.md" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

```go
package main

import (
	"context"
	"encoding/json"
	"fmt"
	"log"

	op "github.com/interledger/open-payments-go"
)

func main() {
	// Initialize Open Payments client
	client, err := op.NewAuthenticatedClient(WALLET_ADDRESS_URL, PRIVATE_KEY_BASE_64, KEY_ID)
	if err != nil {
		log.Fatalf("Error creating authenticated client: %v\n", err)
	}

	// Complete incoming payment
	incomingPayment, err := client.IncomingPayment.Complete(context.TODO(), op.IncomingPaymentCompleteParams{
		URL:         INCOMING_PAYMENT_URL,
		AccessToken: ACCESS_TOKEN,
	})
	if err != nil {
		log.Fatalf("Error completing incoming payment: %v\n", err)
	}

	// Output
	incomingPaymentJSON, err := json.MarshalIndent(incomingPayment, "", "  ")
	if err != nil {
		log.Fatalf("Error marshaling incoming payment: %v\n", err)
	}
	fmt.Println("INCOMING PAYMENT:", string(incomingPaymentJSON))
}
```

</TabItem>
</Tabs>

## References

- [API specification](/apis/resource-server/operations/complete-incoming-payment)
