---
title: Create an outgoing payment
tableOfContents:
  maxHeadingLevel: 2
---

import { CodeBlock, LinkOut, Tooltip } from '@interledger/docs-design-system'
import { Tabs, TabItem, LinkButton } from '@astrojs/starlight/components'
import ChunkedSnippet from '/src/components/ChunkedSnippet.astro'
import Begin from '/src/partials/before-you-begin.mdx'
import Ts from '/src/partials/ts-init-config.mdx'
import TsImport from '/src/partials/ts-import-initialize.mdx'

After a quote is accepted and the authorized client obtains the requisite grant from the authorization server of the sender's <Tooltip content="Account servicing entity" client: load><span>ASE</span></Tooltip>, the client can create an outgoing payment resource against the sender's wallet address.

These code snippets create an outgoing payment to a given wallet address. The amount of the outgoing payment is based on the amounts in the associated quote.

## Before you begin

<Begin />

## Create an outgoing payment resource

<Tabs>
<TabItem label='TypeScript/JavaScript' icon='seti:javascript'>
<LinkButton href="https://github.com/interledger/open-payments-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<details>
  <summary>Initial configuration</summary>
  <Ts />
</details>

<TsImport />

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.ts"
  l="node"
  chunk="3"
/>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.ts"
  l="node"
  chunk="4"
/>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.ts"
  l="node"
  chunk="5"
/>

For TypeScript, run `tsx path/to/directory/index.ts`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/outgoing-payment/outgoing-payment-create.ts'>View full TS source</LinkOut>

For JavaScript, run `node path/to/directory/index.js`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/outgoing-payment/outgoing-payment-create.js'>View full JS source</LinkOut>

</TabItem>
<TabItem label="Rust" icon='seti:rust'>
<LinkButton href="https://github.com/interledger/open-payments-rust/tree/main/src/snippets#readme" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.rs"
  l="rust"
  chunk="1"
/>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.rs"
  l="rust"
  chunk="2"
/>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.rs"
  l="rust"
  chunk="3"
/>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.rs"
  l="rust"
  chunk="4"
/>

<ChunkedSnippet
  source="outgoing-payment/outgoing-payment-create.rs"
  l="rust"
  chunk="5"
/>

<p>
  <LinkOut href="https://github.com/interledger/open-payments/blob/main/snippets/rust/outgoing-payment/outgoing-payment-create.rs">
    View full Rust source
  </LinkOut>
</p>

</TabItem>
<TabItem label="PHP" icon='seti:php'>
<LinkButton href="https://github.com/interledger/open-payments-php-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

```php
// Import dependencies
use OpenPayments\AuthClient;
use OpenPayments\Config\Config;

// Initialize Open Payments client
$config = new Config(
    $WALLET_ADDRESS,
    $PRIVATE_KEY,
    $KEY_ID
);
$opClient = new AuthClient($config);
```

#### Without amount

```php
 // Create outgoing payment without amount
$newOutgoingPayment = $opClient->outgoingPayment()->create(
    [
        'url' => $wallet->resourceServer,
        'access_token' => $OUTGOING_PAYMENT_GRANT_ACCESS_TOKEN
    ],
    [
        'walletAddress' => $config->getWalletAddressUrl(),
        'quoteId' => $QUOTE_URL,
        'metadata' => [
            'description' => 'Test outgoing payment',
            'reference' => '1234567890',
            'invoiceId' => '1234567890',
            'customData' => [
                'key1' => 'value1',
                'key2' => 'value2'
            ]
        ],
    ]
);
```

#### With amount

```php
// Create outgoing payment with amount
$newOutgoingPayment = $opClient->outgoingPayment()->create(
    [
        'url' => $wallet->resourceServer,
        'access_token' => $OUTGOING_PAYMENT_GRANT_ACCESS_TOKEN
    ],
    [
        'walletAddress' => $config->getWalletAddressUrl(),
        'incomingPayment' => $INCOMING_PAYMENT_URL,
        'debitAmount' => [
            'value' => '9',
            'assetCode' => 'USD',
            'assetScale' => 2
        ],
        'metadata' => [
            'description' => 'Test outgoing payment',
            'reference' => '1234567890',
            'invoiceId' => '1234567890',
            'customData' => [
                'key1' => 'value1',
                'key2' => 'value2'
            ]
        ],
    ]
);
```

```php
// Output
echo 'OUTGOING_PAYMENT_URL: '.$newOutgoingPayment->id . PHP_EOL;
echo 'OUTGOING_PAYMENT OBJECT: ' . PHP_EOL . print_r($newOutgoingPayment, true) . PHP_EOL;
```

<p>
  <LinkOut href="https://github.com/interledger/open-payments-php-snippets/blob/main/src/Command/OutgoingPayment/OutgoingPaymentCreate.php">
    View full source without amount
  </LinkOut>
</p>
<p>
  <LinkOut href="https://github.com/interledger/open-payments-php-snippets/blob/main/src/Command/OutgoingPayment/OutgoingPaymentCreateAmount.php">
    View full source with amount
  </LinkOut>
</p>

</TabItem>

<TabItem label="Go" icon='seti:go'>
<LinkButton href="https://github.com/interledger/open-payments-go/blob/main/README.md" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

```go
package main

import (
	"context"
	"encoding/json"
	"fmt"
	"log"

  op "github.com/interledger/open-payments-go"
  rs "github.com/interledger/open-payments-go/generated/resourceserver"

)

func main() {
  // Initialize Open Payments client
  client, err := op.NewAuthenticatedClient(WALLET_ADDRESS_URL, PRIVATE_KEY_BASE_64, KEY_ID)
  if err != nil {
    log.Fatalf("Error creating authenticated client: %v\n", err)
  }

  // Create outgoing payment
  var payload rs.CreateOutgoingPaymentRequest
  if err := payload.FromCreateOutgoingPaymentWithQuote(rs.CreateOutgoingPaymentWithQuote{
    WalletAddressSchema: WALLET_ADDRESS_URL,
    QuoteId:             QUOTE_URL,
  }); err != nil {
    log.Fatalf("Error creating payload: %v\n", err)
  }

  outgoingPayment, err := client.OutgoingPayment.Create(context.TODO(), op.OutgoingPaymentCreateParams{
    BaseURL:     RESOURCE_SERVER_URL,
    AccessToken: OUTGOING_PAYMENT_ACCESS_TOKEN,
    Payload:     payload,
  })
  if err != nil {
    log.Fatalf("Error creating outgoing payment: %v\n", err)
  }

  // Output
  outgoingPaymentJSON, err := json.MarshalIndent(outgoingPayment, "", "  ")
  if err != nil {
    log.Fatalf("Error marshaling outgoing payment: %v\n", err)
  }
  fmt.Println("OUTGOING PAYMENT:", string(outgoingPaymentJSON))
  fmt.Println("OUTGOING_PAYMENT_URL:", *outgoingPayment.Id)
}
```

</TabItem>
</Tabs>

## References

- [API specification](/apis/resource-server/operations/create-outgoing-payment)
