---
title: Continue a grant request
---

import { CodeBlock, LinkOut } from '@interledger/docs-design-system'
import { Tabs, TabItem, LinkButton } from '@astrojs/starlight/components'
import ChunkedSnippet from '/src/components/ChunkedSnippet.astro'
import Begin from '/src/partials/before-you-begin.mdx'
import Ts from '/src/partials/ts-init-config.mdx'
import TsImport from '/src/partials/ts-import-initialize.mdx'
import PhpImport from '/src/partials/php-import-initialize.mdx'

During a grant request flow, an authorization server can require an individual (typically a client's end user) to approve the grant by interacting directly with the server. For example, by tapping an Approve button on a web page provided by the auth server.

After the individual approves the grant, the auth server sends the client an interaction reference. The client must send a continuation request containing the reference back to the authorization server to obtain an access token.

These code snippets enable an authorized client to send a grant continuation request to the authorization server.

:::note[Continue request timing]
After the user completes their interaction with the identity provider (IdP), they should be redirected back to your application. At this point, you can make the grant continuation request. In scenarios where a user interface is not available, consider implementing a polling mechanism to check for the completion of the interaction.
:::

## Before you begin

<Begin />

## Issue grant continuation request

<Tabs>
<TabItem label='TypeScript/JavaScript' icon='seti:javascript'>
<LinkButton href="https://github.com/interledger/open-payments-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<details>
  <summary>Initial configuration</summary>
  <Ts />
</details>

<TsImport />

<ChunkedSnippet source="grant/grant-continuation.ts" l="node" chunk="3" />

<ChunkedSnippet source="grant/grant-continuation.ts" l="node" chunk="4" />

<ChunkedSnippet source="grant/grant-continuation.ts" l="node" chunk="5" />

For TypeScript, run `tsx path/to/directory/index.ts`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/grant/grant-continuation.ts'>View full TS source</LinkOut>

For JavaScript, run `node path/to/directory/index.js`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/grant/grant-continuation.js'>View full JS source</LinkOut>

</TabItem>
<TabItem label="Rust" icon='seti:rust'>
<LinkButton href="https://github.com/interledger/open-payments-rust/tree/main/src/snippets#readme" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<ChunkedSnippet source="grant/grant-continuation.rs" l="rust" chunk="1" />

<ChunkedSnippet source="grant/grant-continuation.rs" l="rust" chunk="2" />

<ChunkedSnippet source="grant/grant-continuation.rs" l="rust" chunk="3" />

<ChunkedSnippet source="grant/grant-continuation.rs" l="rust" chunk="4" />

<p>
  <LinkOut href="https://github.com/interledger/open-payments/blob/main/snippets/rust/grant/grant-continuation.rs">
    View full Rust source
  </LinkOut>
</p>

</TabItem>
<TabItem label="PHP" icon='seti:php'>
<LinkButton href="https://github.com/interledger/open-payments-php-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<PhpImport />

<ChunkedSnippet
  source="https://raw.githubusercontent.com/interledger/open-payments-php-snippets/refs/heads/main/src/Command/Grant/GrantContinuation.php"
  chunk="3"
/>
<ChunkedSnippet
  source="https://raw.githubusercontent.com/interledger/open-payments-php-snippets/refs/heads/main/src/Command/Grant/GrantContinuation.php"
  chunk="4"
/>
<ChunkedSnippet
  source="https://raw.githubusercontent.com/interledger/open-payments-php-snippets/refs/heads/main/src/Command/Grant/GrantContinuation.php"
  chunk="5"
/>
<p><LinkOut href='https://github.com/interledger/open-payments-php-snippets/blob/main/src/Command/Grant/GrantContinuation.php'>View full source</LinkOut></p>
</TabItem>

<TabItem label="Go" icon='seti:go'>
<LinkButton href="https://github.com/interledger/open-payments-go/blob/main/README.md" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

```go
package main

import (
	"context"
	"encoding/json"
	"fmt"
	"log"

	op "github.com/interledger/open-payments-go"
)

func main() {
	// Initialize Open Payments client
	client, err := op.NewAuthenticatedClient(WALLET_ADDRESS_URL, PRIVATE_KEY_BASE_64, KEY_ID)
	if err != nil {
		log.Fatalf("Error creating authenticated client: %v\n", err)
	}

	// Continue grant
	grant, err := client.Grant.Continue(context.TODO(), op.GrantContinueParams{
		URL:         CONTINUE_URI,
		AccessToken: CONTINUE_ACCESS_TOKEN,
    InteractRef: INTERACT_REF,
	})
	if err != nil {
		log.Fatalf("Error continuing grant: %v\n", err)
	}

  // Ensure the grant is finalized
  if grant.AccessToken == nil {
    log.Fatal("Expected finalized grant. Received non-finalized grant.")
  }

	// Output
	grantJSON, err := json.MarshalIndent(grant, "", "  ")
	if err != nil {
		log.Fatalf("Error marshaling grant: %v\n", err)
	}
	fmt.Println("GRANT:", string(grantJSON))
	fmt.Println("OUTGOING_PAYMENT_ACCESS_TOKEN =", grant.AccessToken.Value)
	fmt.Println("OUTGOING_PAYMENT_ACCESS_TOKEN_MANAGE_URL =", grant.AccessToken.Manage)
}
```

  </TabItem>
  <TabItem label='Java' icon='seti:java'>
    <LinkButton
      href="https://github.com/interledger/open-payments-java?tab=readme-ov-file#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

    ```java wrap
    // 1. Import:
    import org.interledger.openpayments.httpclient.OpenPaymentsHttpClient;
    import org.interledger.openpayments.IOpenPaymentsClient;

    // 2. Client instance using HTTP:
    var client = OpenPaymentsHttpClient.defaultClient(
    "WalletAddress",
    "PrivateKeyPEM",
    "KeyId"
    );

    // 3. Retrieve the wallets:
    var senderWallet = client.getWalletAddress("https://cloudninebank.example.com/customer");
    var receiverWallet = client.getWalletAddress("https://cloudninebank.example.com/merchant");

    // 4. Create incoming payment:
    var grantRequest = this.client.createGrantIncomingPayment(receiverWallet);
    var incomingPayment = this.client.createIncomingPayment(receiverWallet, grantRequest, BigDecimal.valueOf(11.25));

    // 5. Create quote:
    var quoteRequest = this.client.createGrantQuote(senderWallet);
    var quote = this.client.createQuote(quoteRequest.getAccess().getToken(), senderWallet, incomingPayment);

    var urlToOpen = "http://localhost:%d?paymentId=1234".formatted(port);

    // 6. Create outing payment from quote:
    var opContinueInteract = this.client.createGrantContinuation(
    senderWallet,
    quote.getDebitAmount(),
    URI.create(urlToOpen),
    "test"
    );

    // 7. USER APPROVES REQUEST.

    // 8. Finalize/Continue
    var finalized = this.client.createGrantFinalize(opContinueInteract, "Reference from USER interaction.");

    // 9. Logging:
    log.info("FINALIZED: {}", finalized);
    ```
  </TabItem>
</Tabs>

## References

- [API specification](/apis/auth-server/operations/post-continue)
- [Grant negotiation and authorization](/identity/grants)
