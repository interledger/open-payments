---
title: Rotate an access token
---

import { CodeBlock, LinkOut } from '@interledger/docs-design-system'
import { Tabs, TabItem, LinkButton } from '@astrojs/starlight/components'
import ChunkedSnippet from '/src/components/ChunkedSnippet.astro'
import Begin from '/src/partials/before-you-begin.mdx'
import Ts from '/src/partials/ts-init-config.mdx'
import TsImport from '/src/partials/ts-import-initialize.mdx'
import PhpImport from '/src/partials/php-import-initialize.mdx'

Rotating an access token consists of the authorization server issuing a new token in place of the existing token, with the same rights and properties as the original token. If, for example, an access token expires, an authorized client can request the token be rotated.

All access tokens in Open Payments have a 10-minute lifespan by default. This includes new access tokens issued as a result of a rotate request.

These code snippets enable the client to call a management endpoint to rotate the specified access token.

## Before you begin

<Begin />

## Rotate an access token

<Tabs>
<TabItem label='TypeScript/JavaScript' icon='seti:javascript'>
<LinkButton href="https://github.com/interledger/open-payments-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<details>
  <summary>Initial configuration</summary>
  <Ts />
</details>

<TsImport />

<ChunkedSnippet source="token/token-rotate.ts" l="node" chunk="3" />

<ChunkedSnippet source="token/token-rotate.ts" l="node" chunk="4" />

For TypeScript, run `tsx path/to/directory/index.ts`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/token/token-rotate.ts'>View full TS source</LinkOut>

For JavaScript, run `node path/to/directory/index.js`. <LinkOut href='https://github.com/interledger/open-payments/blob/main/snippets/node/token/token-rotate.js'>View full JS source</LinkOut>

</TabItem>
<TabItem label="Rust" icon='seti:rust'>
<LinkButton href="https://github.com/interledger/open-payments-rust/tree/main/src/snippets#readme" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<ChunkedSnippet source="token/token-rotate.rs" l="rust" chunk="1" />

<ChunkedSnippet source="token/token-rotate.rs" l="rust" chunk="2" />

<ChunkedSnippet source="token/token-rotate.rs" l="rust" chunk="3" />

<ChunkedSnippet source="token/token-rotate.rs" l="rust" chunk="4" />

<p>
  <LinkOut href="https://github.com/interledger/open-payments/blob/main/snippets/rust/token/token-rotate.rs">
    View full Rust source
  </LinkOut>
</p>

</TabItem>
<TabItem label="PHP" icon='seti:php'>
<LinkButton href="https://github.com/interledger/open-payments-php-snippets/blob/main/README.md#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

<PhpImport />

<ChunkedSnippet
  source="https://raw.githubusercontent.com/interledger/open-payments-php-snippets/refs/heads/main/src/Command/Token/TokenRotate.php"
  chunk="3"
/>
<ChunkedSnippet
  source="https://raw.githubusercontent.com/interledger/open-payments-php-snippets/refs/heads/main/src/Command/Token/TokenRotate.php"
  chunk="4"
/>

<p><LinkOut href='https://github.com/interledger/open-payments-php-snippets/blob/main/src/Command/Token/TokenRotate.php'>View full source</LinkOut></p>
</TabItem>
<TabItem label="Go" icon='seti:go'>
<LinkButton href="https://github.com/interledger/open-payments-go/blob/main/README.md" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

```go
package main

import (
  "context"
  "encoding/json"
  "fmt"
  "log"

  op "github.com/interledger/open-payments-go"
)

func main() {
  // Initialize Open Payments authenticated client
  client, err := op.NewAuthenticatedClient(
    WALLET_ADDRESS_URL,
    PRIVATE_KEY_BASE_64,
    KEY_ID,
  )
  if err != nil {
    log.Fatalf("Error creating authenticated client: %v\n", err)
  }

  // Rotate access token
  rotatedToken, err := client.Token.Rotate(context.TODO(), op.TokenRotateParams{
    URL:         MANAGE_URL,
    AccessToken: ACCESS_TOKEN,
  })
  if err != nil {
    log.Fatalf("Error rotating access token: %v\n", err)
  }

  // Output as JSON
  rotatedTokenJSON, err := json.MarshalIndent(rotatedToken, "", "  ")
  if err != nil {
    log.Fatalf("Error marshaling rotated token: %v\n", err)
  }

  fmt.Println("ROTATED ACCESS TOKEN:", string(rotatedTokenJSON))
}
```

</TabItem>
<TabItem label='Java' icon='seti:java'>
<LinkButton href="https://github.com/interledger/open-payments-java?tab=readme-ov-file#prerequisites" target="_blank" icon="external" iconPlacement="start">Prerequisites</LinkButton>

    ```java wrap
    // 1. Import:
    import org.interledger.openpayments.httpclient.OpenPaymentsHttpClient;
    import org.interledger.openpayments.IOpenPaymentsClient;

    // 2. Client instance using HTTP:
    var client = OpenPaymentsHttpClient.defaultClient(
    "WalletAddress",
    "PrivateKeyPEM",
    "KeyId"
    );

    // 3. Retrieve the wallets:
    var receiverWallet = client.getWalletAddress("https://cloudninebank.example.com/merchant");

    // 4. Create grant request:
    var grantRequest = this.client.createGrantIncomingPayment(receiverWallet);

    // 5. Rotate grant request:
    // Auth server will be retrieved from [receiverWallet].
    var rotatedGrant = this.client.rotateToken(receiverWallet, grantRequest.getToken());

    // 6. Logging:
    log.info("GRANT: {}", rotatedGrant);
    ```

</TabItem>
</Tabs>

## References

- [API specification](/apis/auth-server/operations/post-token)
